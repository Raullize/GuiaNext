<img width=100% src="https://capsule-render.vercel.app/api?type=waving&color=00A0D2&height=120&section=header"/>

# üåé Internacionaliza√ß√£o no Next.js üåç

A internacionaliza√ß√£o (i18n) permite que seu aplicativo Next.js seja acess√≠vel para usu√°rios de diferentes idiomas e regi√µes. O Next.js oferece suporte integrado para internacionaliza√ß√£o, facilitando a cria√ß√£o de aplicativos multil√≠ngues. Neste guia, vamos explorar como implementar e gerenciar recursos de internacionaliza√ß√£o em projetos Next.js.

## üìö Conceitos B√°sicos

Antes de mergulharmos na implementa√ß√£o, vamos entender alguns conceitos importantes:

- **Locale**: Identificador para um conjunto de prefer√™ncias de idioma e regi√£o (ex: pt-BR, en-US, es-ES)
- **Detec√ß√£o de Idioma**: Identificar automaticamente o idioma preferido do usu√°rio
- **Tradu√ß√µes**: Strings e mensagens em diferentes idiomas
- **Formata√ß√£o**: Ajuste de datas, n√∫meros e moedas para diferentes locales
- **Roteamento i18n**: Navega√ß√£o entre diferentes vers√µes de idioma do seu site

## üîÑ Configurando i18n no Next.js

### Configura√ß√£o no App Router (Next.js 13+)

No App Router, a internacionaliza√ß√£o √© implementada principalmente atrav√©s do sistema de pastas:

#### 1. Estrutura de Pasta Baseada em Subpastas

```
app/
‚îú‚îÄ‚îÄ [lang]/
‚îÇ   ‚îú‚îÄ‚îÄ page.js
‚îÇ   ‚îú‚îÄ‚îÄ sobre/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.js
‚îÇ   ‚îî‚îÄ‚îÄ produtos/
‚îÇ       ‚îî‚îÄ‚îÄ [...slug]/
‚îÇ           ‚îî‚îÄ‚îÄ page.js
‚îî‚îÄ‚îÄ layout.js
```

#### 2. Middleware para Detec√ß√£o de Idioma

Crie um arquivo `middleware.js` na raiz do projeto:

```javascript
// middleware.js
import { NextResponse } from 'next/server';

// Locales suportados
const locales = ['pt-BR', 'en-US', 'es-ES'];
const defaultLocale = 'pt-BR';

// Fun√ß√£o para verificar se o caminho j√° come√ßa com um locale
function pathnameHasLocale(pathname) {
  return locales.some(
    locale => pathname.startsWith(`/${locale}/`) || pathname === `/${locale}`
  );
}

export function middleware(request) {
  const { pathname } = request.nextUrl;
  
  // Pular middleware para arquivos est√°ticos e rotas de API
  if (
    pathname.startsWith('/_next') ||
    pathname.startsWith('/api/') ||
    pathname.includes('/images/') ||
    pathname.includes('.') // arquivos com extens√£o
  ) {
    return NextResponse.next();
  }

  // Verificar se j√° temos um locale no caminho
  if (pathnameHasLocale(pathname)) {
    return NextResponse.next();
  }

  // Detectar o idioma preferido do usu√°rio a partir do cabe√ßalho Accept-Language
  const acceptLanguage = request.headers.get('accept-language') || '';
  const preferredLocale = acceptLanguage
    .split(',')
    .map(lang => lang.split(';')[0].trim())
    .find(lang => locales.includes(lang)) || defaultLocale;

  // Redirecionar para o mesmo caminho com o locale preferido
  return NextResponse.redirect(
    new URL(`/${preferredLocale}${pathname === '/' ? '' : pathname}`, request.url)
  );
}

export const config = {
  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],
};
```

#### 3. Par√¢metros Din√¢micos para Locale

```javascript
// app/[lang]/layout.js
export async function generateStaticParams() {
  return [
    { lang: 'pt-BR' },
    { lang: 'en-US' },
    { lang: 'es-ES' },
  ];
}

export default function Layout({ children, params }) {
  return (
    <html lang={params.lang}>
      <body>{children}</body>
    </html>
  );
}
```

### Configura√ß√£o no Pages Router (Legacy)

Para projetos que usam o Pages Router, a configura√ß√£o de i18n √© feita no arquivo `next.config.js`:

```javascript
// next.config.js
module.exports = {
  i18n: {
    // Locales suportados
    locales: ['pt-BR', 'en-US', 'es-ES'],
    // Locale padr√£o
    defaultLocale: 'pt-BR',
    // Dom√≠nios espec√≠ficos para cada locale (opcional)
    domains: [
      {
        domain: 'exemplo.com.br',
        defaultLocale: 'pt-BR',
      },
      {
        domain: 'example.com',
        defaultLocale: 'en-US',
      },
      {
        domain: 'ejemplo.com',
        defaultLocale: 'es-ES',
      },
    ],
    // Estrat√©gia de detec√ß√£o de locale
    localeDetection: true,
  },
};
```

## üî§ Gerenciamento de Tradu√ß√µes

Existem v√°rias bibliotecas para gerenciar tradu√ß√µes em Next.js. Vamos explorar algumas das mais populares:

### 1. next-intl

Uma das solu√ß√µes mais completas para internacionaliza√ß√£o no Next.js:

#### Instala√ß√£o

```bash
npm install next-intl
```

#### Configura√ß√£o com App Router

```javascript
// messages/pt-BR.json
{
  "Index": {
    "title": "Bem-vindo ao nosso site",
    "subtitle": "Descubra nossos produtos incr√≠veis",
    "cta": "Come√ßar agora"
  },
  "Products": {
    "title": "Nossos Produtos",
    "notFound": "Produto n√£o encontrado"
  }
}
```

```javascript
// app/[locale]/layout.js
import { NextIntlClientProvider } from 'next-intl';
import { notFound } from 'next/navigation';

export function generateStaticParams() {
  return [{ locale: 'pt-BR' }, { locale: 'en-US' }, { locale: 'es-ES' }];
}

export default async function LocaleLayout({ children, params: { locale } }) {
  let messages;
  try {
    messages = (await import(`../../messages/${locale}.json`)).default;
  } catch (error) {
    notFound();
  }

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider locale={locale} messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

#### Uso nas P√°ginas

```javascript
// app/[locale]/page.js
import { useTranslations } from 'next-intl';

export default function Home() {
  const t = useTranslations('Index');
  
  return (
    <main>
      <h1>{t('title')}</h1>
      <p>{t('subtitle')}</p>
      <button>{t('cta')}</button>
    </main>
  );
}
```

### 2. react-i18next

Outra op√ß√£o popular para gerenciar tradu√ß√µes:

#### Instala√ß√£o

```bash
npm install react-i18next i18next
```

#### Configura√ß√£o

```javascript
// i18n.js
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';

// Recursos de tradu√ß√£o
const resources = {
  'pt-BR': {
    translation: {
      'welcome': 'Bem-vindo ao nosso site',
      'about': 'Sobre n√≥s',
      'contact': 'Contato'
    }
  },
  'en-US': {
    translation: {
      'welcome': 'Welcome to our website',
      'about': 'About us',
      'contact': 'Contact'
    }
  },
  'es-ES': {
    translation: {
      'welcome': 'Bienvenido a nuestro sitio',
      'about': 'Sobre nosotros',
      'contact': 'Contacto'
    }
  }
};

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng: 'pt-BR', // idioma inicial
    fallbackLng: 'pt-BR',
    interpolation: {
      escapeValue: false // n√£o necess√°rio para React
    }
  });

export default i18n;
```

```javascript
// _app.js (Pages Router)
import '../i18n';
import { useRouter } from 'next/router';
import { useEffect } from 'react';
import i18n from '../i18n';

function MyApp({ Component, pageProps }) {
  const router = useRouter();
  
  useEffect(() => {
    if (router.locale) {
      i18n.changeLanguage(router.locale);
    }
  }, [router.locale]);
  
  return <Component {...pageProps} />;
}

export default MyApp;
```

#### Uso nas P√°ginas

```javascript
// pages/index.js
import { useTranslation } from 'react-i18next';

export default function Home() {
  const { t } = useTranslation();
  
  return (
    <div>
      <h1>{t('welcome')}</h1>
      <nav>
        <ul>
          <li>{t('about')}</li>
          <li>{t('contact')}</li>
        </ul>
      </nav>
    </div>
  );
}
```

## üìÖ Formata√ß√£o de Datas, N√∫meros e Moedas

Para formatar datas, n√∫meros e moedas de acordo com o locale, podemos usar a API Intl nativa do JavaScript:

```javascript
// Formata√ß√£o de data
function formatarData(data, locale) {
  return new Intl.DateTimeFormat(locale, {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
  }).format(data);
}

// Formata√ß√£o de n√∫meros
function formatarNumero(numero, locale) {
  return new Intl.NumberFormat(locale).format(numero);
}

// Formata√ß√£o de moeda
function formatarMoeda(valor, locale, moeda = 'BRL') {
  return new Intl.NumberFormat(locale, {
    style: 'currency',
    currency: moeda
  }).format(valor);
}

// Exemplo de uso
const data = new Date();
const numero = 1234567.89;
const preco = 99.99;

// Para pt-BR
console.log(formatarData(data, 'pt-BR')); // 15 de mar√ßo de 2023
console.log(formatarNumero(numero, 'pt-BR')); // 1.234.567,89
console.log(formatarMoeda(preco, 'pt-BR')); // R$ 99,99

// Para en-US
console.log(formatarData(data, 'en-US')); // March 15, 2023
console.log(formatarNumero(numero, 'en-US')); // 1,234,567.89
console.log(formatarMoeda(preco, 'en-US', 'USD')); // $99.99
```

### Integra√ß√£o com next-intl

A biblioteca `next-intl` tamb√©m oferece formatadores para datas, n√∫meros e moedas:

```javascript
// app/[locale]/componentes/formatadores.js
'use client';
import { useFormatter } from 'next-intl';

export function FormatadoresExemplo() {
  const format = useFormatter();
  const data = new Date();
  const numero = 1234567.89;
  const preco = 99.99;
  
  return (
    <div>
      <p>Data: {format.dateTime(data, {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      })}</p>
      
      <p>N√∫mero: {format.number(numero)}</p>
      
      <p>Pre√ßo: {format.number(preco, {
        style: 'currency',
        currency: 'BRL'
      })}</p>
    </div>
  );
}
```

## üîÑ Altern√¢ncia de Idiomas

Vamos criar um seletor de idioma que funciona tanto no App Router quanto no Pages Router:

### Para App Router

```javascript
// app/[locale]/componentes/seletor-idioma.js
'use client';
import { usePathname, useRouter } from 'next/navigation';
import Link from 'next/link';

export default function SeletorIdioma() {
  const pathname = usePathname();
  const locales = ['pt-BR', 'en-US', 'es-ES'];
  const currentLocale = pathname.split('/')[1];
  
  // Obter o caminho sem o locale
  const pathnameWithoutLocale = pathname.split('/').slice(2).join('/');
  
  return (
    <div className="seletor-idioma">
      <ul>
        {locales.map((locale) => (
          <li key={locale}>
            <Link 
              href={`/${locale}/${pathnameWithoutLocale}`}
              className={locale === currentLocale ? 'ativo' : ''}
            >
              {locale === 'pt-BR' ? 'üáßüá∑ Portugu√™s' : 
               locale === 'en-US' ? 'üá∫üá∏ English' : 'üá™üá∏ Espa√±ol'}
            </Link>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

### Para Pages Router

```javascript
// components/seletor-idioma.js
import { useRouter } from 'next/router';
import Link from 'next/link';

export default function SeletorIdioma() {
  const router = useRouter();
  const { pathname, asPath, query } = router;
  
  const locales = router.locales || ['pt-BR', 'en-US', 'es-ES'];
  
  return (
    <div className="seletor-idioma">
      <ul>
        {locales.map((locale) => (
          <li key={locale}>
            <Link 
              href={{ pathname, query }} 
              as={asPath}
              locale={locale}
              className={locale === router.locale ? 'ativo' : ''}
            >
              {locale === 'pt-BR' ? 'üáßüá∑ Portugu√™s' : 
               locale === 'en-US' ? 'üá∫üá∏ English' : 'üá™üá∏ Espa√±ol'}
            </Link>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

## üîç SEO para Sites Multil√≠ngues

Para um bom SEO em sites multil√≠ngues, √© importante incluir as tags apropriadas:

### Links Hreflang no App Router

```javascript
// app/[locale]/layout.js
export default function Layout({ children, params }) {
  const { locale } = params;
  const locales = ['pt-BR', 'en-US', 'es-ES'];
  const pathname = '/'; // Obtenha dinamicamente o caminho atual
  
  const alternateLanguages = {};
  locales.forEach((lang) => {
    alternateLanguages[lang] = `https://meusite.com/${lang}${pathname}`;
  });
  
  return (
    <html lang={locale}>
      <head>
        {/* Outros metadados */}
        {locales.map((lang) => (
          <link
            key={lang}
            rel="alternate"
            hrefLang={lang}
            href={alternateLanguages[lang]}
          />
        ))}
        <link
          rel="alternate"
          hrefLang="x-default"
          href={`https://meusite.com/pt-BR${pathname}`}
        />
      </head>
      <body>{children}</body>
    </html>
  );
}
```

### Links Hreflang no Pages Router

```javascript
// pages/_app.js
import Head from 'next/head';
import { useRouter } from 'next/router';

function MyApp({ Component, pageProps }) {
  const router = useRouter();
  const { locale, locales, asPath } = router;
  
  return (
    <>
      <Head>
        {locales.map((lang) => (
          <link
            key={lang}
            rel="alternate"
            hrefLang={lang}
            href={`https://meusite.com/${lang}${asPath}`}
          />
        ))}
        <link
          rel="alternate"
          hrefLang="x-default"
          href={`https://meusite.com/pt-BR${asPath}`}
        />
      </Head>
      <Component {...pageProps} />
    </>
  );
}

export default MyApp;
```

## üåê URL Multil√≠ngues

Diferentes estrat√©gias para URLs multil√≠ngues:

### 1. Subpath Routing (Recomendado)

```
https://meusite.com/pt-BR/produtos
https://meusite.com/en-US/products
https://meusite.com/es-ES/productos
```

### 2. Domain Routing

```
https://meusite.com.br/ (pt-BR)
https://mysite.com/ (en-US)
https://misitio.com/ (es-ES)
```

Para implementar Domain Routing no Pages Router:

```javascript
// next.config.js
module.exports = {
  i18n: {
    locales: ['pt-BR', 'en-US', 'es-ES'],
    defaultLocale: 'pt-BR',
    domains: [
      {
        domain: 'meusite.com.br',
        defaultLocale: 'pt-BR',
      },
      {
        domain: 'mysite.com',
        defaultLocale: 'en-US',
      },
      {
        domain: 'misitio.com',
        defaultLocale: 'es-ES',
      },
    ],
  },
};
```

## üìê Considera√ß√µes de Design para Interfaces Multil√≠ngues

Ao criar interfaces para diferentes idiomas, √© importante considerar:

1. **Espa√ßo para texto**: Alguns idiomas precisam de mais espa√ßo que outros
2. **Dire√ß√£o de texto**: Suporte para idiomas RTL (right-to-left) como √°rabe e hebraico
3. **Formata√ß√£o de datas e n√∫meros**: Diferentes formatos para diferentes regi√µes
4. **Pluraliza√ß√£o**: Regras diferentes em cada idioma

### Exemplo de Pluraliza√ß√£o com next-intl

```javascript
// messages/pt-BR.json
{
  "Cart": {
    "items": {
      "one": "{count} item no carrinho",
      "other": "{count} itens no carrinho"
    }
  }
}
```

```javascript
// app/[locale]/carrinho/page.js
'use client';
import { useTranslations } from 'next-intl';

export default function CarrinhoPage() {
  const t = useTranslations('Cart');
  const itemCount = 5;
  
  return (
    <div>
      <h1>Carrinho de Compras</h1>
      <p>{t('items', { count: itemCount })}</p>
    </div>
  );
}
```

## üöÄ Melhores Pr√°ticas

1. **Separar conte√∫do de c√≥digo**: Mantenha as tradu√ß√µes em arquivos JSON separados
2. **Usar ferramentas de gest√£o de tradu√ß√µes**: Ferramentas como POEditor, Phrase ou Crowdin
3. **Implementar fallback para tradu√ß√µes ausentes**: Sempre ter um texto de backup
4. **Testar em diferentes idiomas**: Verificar quebras de layout e outros problemas
5. **Considerar tradu√ß√µes baseadas em contexto**: Tradu√ß√µes diferentes para a mesma palavra dependendo do contexto
6. **Automatizar exporta√ß√£o/importa√ß√£o de tradu√ß√µes**: Facilitar o trabalho dos tradutores

## üõ†Ô∏è Recursos e Ferramentas √öteis

- **Bibliotecas de i18n**:
  - [next-intl](https://next-intl-docs.vercel.app/)
  - [react-i18next](https://react.i18next.com/)
  - [next-translate](https://github.com/vinissimus/next-translate)
  - [lingui](https://lingui.js.org/)

- **Ferramentas de Gest√£o de Tradu√ß√µes**:
  - [Phrase](https://phrase.com/)
  - [Crowdin](https://crowdin.com/)
  - [POEditor](https://poeditor.com/)
  - [Lokalise](https://lokalise.com/)

- **Documenta√ß√£o Oficial**:
  - [Internacionaliza√ß√£o no App Router](https://nextjs.org/docs/app/building-your-application/routing/internationalization)
  - [Internacionaliza√ß√£o no Pages Router](https://nextjs.org/docs/pages/building-your-application/routing/internationalization)

## üåç Exemplo Completo de Aplica√ß√£o Multil√≠ngue

### Estrutura de Pastas (App Router)

```
app/
‚îú‚îÄ‚îÄ [locale]/
‚îÇ   ‚îú‚îÄ‚îÄ page.js
‚îÇ   ‚îú‚îÄ‚îÄ sobre/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.js
‚îÇ   ‚îú‚îÄ‚îÄ produtos/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.js
‚îÇ   ‚îî‚îÄ‚îÄ componentes/
‚îÇ       ‚îú‚îÄ‚îÄ cabecalho.js
‚îÇ       ‚îú‚îÄ‚îÄ rodape.js
‚îÇ       ‚îî‚îÄ‚îÄ seletor-idioma.js
‚îú‚îÄ‚îÄ layout.js
‚îú‚îÄ‚îÄ middleware.js
‚îú‚îÄ‚îÄ i18n.js
‚îî‚îÄ‚îÄ not-found.js
messages/
‚îú‚îÄ‚îÄ pt-BR.json
‚îú‚îÄ‚îÄ en-US.json
‚îî‚îÄ‚îÄ es-ES.json
```

Implementando esse sistema de internacionaliza√ß√£o, seu aplicativo Next.js estar√° pronto para atender usu√°rios de diferentes regi√µes e culturas, proporcionando uma experi√™ncia localizada e personalizada.

---

[üîô Voltar ao √≠ndice principal](../README.md)

<img width=100% src="https://capsule-render.vercel.app/api?type=waving&color=00A0D2&height=120&section=footer"/> 